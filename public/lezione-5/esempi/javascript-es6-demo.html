<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript ES6+ - Demo Interattiva</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .demo-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }

        .demo-section h2 {
            color: #667eea;
            margin-bottom: 15px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .demo-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 15px 0;
        }

        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }

        button:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        button:active {
            transform: translateY(0);
        }

        .output {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-top: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            max-height: 300px;
            overflow-y: auto;
        }

        .output-item {
            margin: 8px 0;
            padding: 8px;
            background: white;
            border-radius: 4px;
        }

        input {
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            min-width: 200px;
        }

        input:focus {
            outline: none;
            border-color: #667eea;
        }

        .counter-display {
            font-size: 48px;
            font-weight: bold;
            color: #667eea;
            text-align: center;
            margin: 20px 0;
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .product-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s;
        }

        .product-card:hover {
            border-color: #667eea;
            transform: translateY(-4px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .product-card h3 {
            color: #333;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .product-card .price {
            color: #667eea;
            font-size: 20px;
            font-weight: bold;
            margin: 8px 0;
        }

        .product-card .category {
            background: #667eea;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            display: inline-block;
            margin-top: 8px;
        }

        code {
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ JavaScript ES6+ Demo Interattiva</h1>

        <!-- Sezione 1: Arrow Functions e Template Literals -->
        <div class="demo-section">
            <h2>1. Arrow Functions & Template Literals</h2>
            <div class="demo-controls">
                <input type="text" id="userName" placeholder="Inserisci il tuo nome" value="Mario">
                <button onclick="demoArrowFunction()">Saluta</button>
                <button onclick="demoTemplateString()">Crea Messaggio</button>
            </div>
            <div id="output1" class="output"></div>
        </div>

        <!-- Sezione 2: Destructuring -->
        <div class="demo-section">
            <h2>2. Destructuring</h2>
            <div class="demo-controls">
                <button onclick="demoArrayDestructuring()">Array Destructuring</button>
                <button onclick="demoObjectDestructuring()">Object Destructuring</button>
            </div>
            <div id="output2" class="output"></div>
        </div>

        <!-- Sezione 3: Spread & Rest Operators -->
        <div class="demo-section">
            <h2>3. Spread & Rest Operators</h2>
            <div class="demo-controls">
                <button onclick="demoSpreadArray()">Spread Array</button>
                <button onclick="demoSpreadObject()">Spread Object</button>
                <button onclick="demoRestParams()">Rest Parameters</button>
            </div>
            <div id="output3" class="output"></div>
        </div>

        <!-- Sezione 4: Array Methods -->
        <div class="demo-section">
            <h2>4. Array Methods (map, filter, reduce)</h2>
            <div class="demo-controls">
                <button onclick="demoMap()">Map (trasforma)</button>
                <button onclick="demoFilter()">Filter (filtra)</button>
                <button onclick="demoReduce()">Reduce (somma)</button>
                <button onclick="demoChaining()">Chaining (combinato)</button>
            </div>
            <div id="output4" class="output"></div>
        </div>

        <!-- Sezione 5: Async/Await -->
        <div class="demo-section">
            <h2>5. Async/Await & Promises</h2>
            <div class="demo-controls">
                <button onclick="demoFetchUsers()">Fetch Users (API)</button>
                <button onclick="demoAsyncOperations()">Operazioni Async Multiple</button>
            </div>
            <div id="output5" class="output"></div>
        </div>

        <!-- Sezione 6: E-commerce Demo (tutto insieme) -->
        <div class="demo-section">
            <h2>6. Demo E-commerce Completa</h2>
            <div class="demo-controls">
                <button onclick="showAllProducts()">Mostra Tutti</button>
                <button onclick="filterByCategory('electronics')">Electronics</button>
                <button onclick="filterByCategory('clothing')">Clothing</button>
                <button onclick="filterByPrice(50)">< â‚¬50</button>
                <button onclick="sortByPrice()">Ordina per Prezzo</button>
            </div>
            <div id="productGrid" class="product-grid"></div>
            <div id="output6" class="output"></div>
        </div>
    </div>

    <script>
        // Dati demo per e-commerce
        const products = [
            { id: 1, name: "Laptop", price: 899.99, category: "electronics", inStock: true },
            { id: 2, name: "Mouse", price: 25.99, category: "electronics", inStock: true },
            { id: 3, name: "T-shirt", price: 19.99, category: "clothing", inStock: false },
            { id: 4, name: "Keyboard", price: 79.99, category: "electronics", inStock: true },
            { id: 5, name: "Jeans", price: 59.99, category: "clothing", inStock: true },
            { id: 6, name: "Headphones", price: 149.99, category: "electronics", inStock: true },
            { id: 7, name: "Jacket", price: 89.99, category: "clothing", inStock: true },
            { id: 8, name: "Monitor", price: 299.99, category: "electronics", inStock: false }
        ];

        // Sezione 1: Arrow Functions
        const demoArrowFunction = () => {
            const name = document.getElementById('userName').value || 'Ospite';
            
            // Arrow function tradizionale
            const saluta = (nome) => `Ciao, ${nome}!`;
            
            // Arrow function con logica
            const getSaluto = (nome) => {
                const ora = new Date().getHours();
                return ora < 12 ? `Buongiorno, ${nome}!` : `Buonasera, ${nome}!`;
            };
            
            const output = document.getElementById('output1');
            output.innerHTML = `
                <div class="output-item">âœ¨ ${saluta(name)}</div>
                <div class="output-item">â° ${getSaluto(name)}</div>
            `;
        };

        const demoTemplateString = () => {
            const name = document.getElementById('userName').value || 'Ospite';
            const age = Math.floor(Math.random() * 50) + 20;
            const city = 'Roma';
            
            // Template literal multiriga con interpolazione
            const message = `
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘        CARTA D'IDENTITÃ€           â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Nome:     ${name.padEnd(20)}     â•‘
â•‘ EtÃ :      ${age} anni              â•‘
â•‘ CittÃ :    ${city.padEnd(20)}     â•‘
â•‘ Stato:    ${age >= 18 ? 'Maggiorenne âœ…' : 'Minorenne âŒ'}  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            `;
            
            document.getElementById('output1').innerHTML = `<pre>${message}</pre>`;
        };

        // Sezione 2: Destructuring
        const demoArrayDestructuring = () => {
            const colors = ['red', 'green', 'blue', 'yellow', 'purple'];
            
            // Destructuring base
            const [first, second] = colors;
            
            // Skipping elements
            const [, , third] = colors;
            
            // Rest operator
            const [primo, ...altri] = colors;
            
            document.getElementById('output2').innerHTML = `
                <div class="output-item">ğŸ¨ Array originale: [${colors.join(', ')}]</div>
                <div class="output-item">1ï¸âƒ£ Primo: <strong>${first}</strong></div>
                <div class="output-item">2ï¸âƒ£ Secondo: <strong>${second}</strong></div>
                <div class="output-item">3ï¸âƒ£ Terzo (skipped 2): <strong>${third}</strong></div>
                <div class="output-item">ğŸ“¦ Primo + altri: <strong>${primo}</strong>, [${altri.join(', ')}]</div>
            `;
        };

        const demoObjectDestructuring = () => {
            const user = {
                id: 1,
                name: 'Mario Rossi',
                email: 'mario@test.com',
                age: 30,
                address: {
                    city: 'Roma',
                    country: 'Italia'
                }
            };
            
            // Destructuring base
            const { name, email } = user;
            
            // Rinominare variabili
            const { name: userName, age: userAge } = user;
            
            // Nested destructuring
            const { address: { city, country } } = user;
            
            document.getElementById('output2').innerHTML = `
                <div class="output-item">ğŸ‘¤ Oggetto originale: ${JSON.stringify(user, null, 2)}</div>
                <div class="output-item">ğŸ“§ Email: <strong>${email}</strong></div>
                <div class="output-item">ğŸ·ï¸ Rinominato: userName = <strong>${userName}</strong>, userAge = <strong>${userAge}</strong></div>
                <div class="output-item">ğŸŒ Nested: <strong>${city}, ${country}</strong></div>
            `;
        };

        // Sezione 3: Spread & Rest
        const demoSpreadArray = () => {
            const arr1 = [1, 2, 3];
            const arr2 = [4, 5, 6];
            
            // Concatenare arrays
            const combined = [...arr1, ...arr2];
            
            // Copiare array
            const copy = [...arr1];
            
            // Aggiungere elementi
            const extended = [0, ...arr1, 3.5, ...arr2, 7];
            
            document.getElementById('output3').innerHTML = `
                <div class="output-item">ğŸ“Š Array 1: [${arr1}]</div>
                <div class="output-item">ğŸ“Š Array 2: [${arr2}]</div>
                <div class="output-item">ğŸ”— Concatenati: [${combined}]</div>
                <div class="output-item">ğŸ“‹ Copia: [${copy}]</div>
                <div class="output-item">â• Esteso: [${extended}]</div>
            `;
        };

        const demoSpreadObject = () => {
            const base = { name: 'Product', price: 100 };
            const details = { category: 'Electronics', inStock: true };
            
            // Merge objects
            const product = { ...base, ...details };
            
            // Override properties
            const discounted = { ...product, price: 80, discount: true };
            
            document.getElementById('output3').innerHTML = `
                <div class="output-item">ğŸ“¦ Base: ${JSON.stringify(base)}</div>
                <div class="output-item">ğŸ“‹ Details: ${JSON.stringify(details)}</div>
                <div class="output-item">ğŸ”— Merged: ${JSON.stringify(product)}</div>
                <div class="output-item">ğŸ’° Discounted: ${JSON.stringify(discounted)}</div>
            `;
        };

        const demoRestParams = () => {
            // Rest parameters
            const sum = (...numbers) => numbers.reduce((total, n) => total + n, 0);
            
            const average = (...numbers) => sum(...numbers) / numbers.length;
            
            const nums1 = [1, 2, 3, 4, 5];
            const nums2 = [10, 20, 30];
            
            document.getElementById('output3').innerHTML = `
                <div class="output-item">â• Somma ${JSON.stringify(nums1)}: <strong>${sum(...nums1)}</strong></div>
                <div class="output-item">â• Somma ${JSON.stringify(nums2)}: <strong>${sum(...nums2)}</strong></div>
                <div class="output-item">ğŸ“Š Media ${JSON.stringify(nums1)}: <strong>${average(...nums1).toFixed(2)}</strong></div>
                <div class="output-item">ğŸ“Š Media ${JSON.stringify(nums2)}: <strong>${average(...nums2).toFixed(2)}</strong></div>
            `;
        };

        // Sezione 4: Array Methods
        const demoMap = () => {
            const prices = [10, 25, 50, 75, 100];
            
            // Applicare sconto 20%
            const discounted = prices.map(price => price * 0.8);
            
            // Trasformare in oggetti
            const products = prices.map((price, index) => ({
                id: index + 1,
                price: price,
                discounted: price * 0.8
            }));
            
            document.getElementById('output4').innerHTML = `
                <div class="output-item">ğŸ’° Prezzi originali: â‚¬${prices.join(', â‚¬')}</div>
                <div class="output-item">ğŸ‰ Con sconto 20%: â‚¬${discounted.map(p => p.toFixed(2)).join(', â‚¬')}</div>
                <div class="output-item">ğŸ“¦ Oggetti: ${JSON.stringify(products, null, 2)}</div>
            `;
        };

        const demoFilter = () => {
            const numbers = [5, 12, 8, 130, 44, 23, 76, 9];
            
            const evenNumbers = numbers.filter(n => n % 2 === 0);
            const greaterThan20 = numbers.filter(n => n > 20);
            const inRange = numbers.filter(n => n >= 10 && n <= 50);
            
            document.getElementById('output4').innerHTML = `
                <div class="output-item">ğŸ”¢ Numeri: [${numbers.join(', ')}]</div>
                <div class="output-item">âœ… Pari: [${evenNumbers.join(', ')}]</div>
                <div class="output-item">â¬†ï¸ Maggiori di 20: [${greaterThan20.join(', ')}]</div>
                <div class="output-item">ğŸ¯ Tra 10 e 50: [${inRange.join(', ')}]</div>
            `;
        };

        const demoReduce = () => {
            const prices = [29.99, 49.99, 19.99, 99.99, 39.99];
            
            // Somma totale
            const total = prices.reduce((sum, price) => sum + price, 0);
            
            // Media
            const average = prices.reduce((sum, price) => sum + price, 0) / prices.length;
            
            // Minimo e massimo
            const min = prices.reduce((min, price) => price < min ? price : min);
            const max = prices.reduce((max, price) => price > max ? price : max);
            
            document.getElementById('output4').innerHTML = `
                <div class="output-item">ğŸ’° Prezzi: â‚¬${prices.join(', â‚¬')}</div>
                <div class="output-item">ğŸ’µ Totale: <strong>â‚¬${total.toFixed(2)}</strong></div>
                <div class="output-item">ğŸ“Š Media: <strong>â‚¬${average.toFixed(2)}</strong></div>
                <div class="output-item">â¬‡ï¸ Minimo: <strong>â‚¬${min.toFixed(2)}</strong></div>
                <div class="output-item">â¬†ï¸ Massimo: <strong>â‚¬${max.toFixed(2)}</strong></div>
            `;
        };

        const demoChaining = () => {
            const sales = [
                { product: 'Laptop', price: 1000, quantity: 2 },
                { product: 'Mouse', price: 25, quantity: 5 },
                { product: 'Keyboard', price: 75, quantity: 3 },
                { product: 'Monitor', price: 300, quantity: 1 }
            ];
            
            // Catena: filtra, mappa, riduci
            const totalHighValue = sales
                .filter(sale => sale.price >= 50)      // Solo prodotti >= â‚¬50
                .map(sale => sale.price * sale.quantity) // Calcola totale per prodotto
                .reduce((sum, total) => sum + total, 0);  // Somma tutti
            
            const highValueProducts = sales
                .filter(sale => sale.price >= 50)
                .map(sale => sale.product);
            
            document.getElementById('output4').innerHTML = `
                <div class="output-item">ğŸ›’ Vendite: ${JSON.stringify(sales, null, 2)}</div>
                <div class="output-item">ğŸ“¦ Prodotti >= â‚¬50: <strong>[${highValueProducts.join(', ')}]</strong></div>
                <div class="output-item">ğŸ’° Totale vendite (>= â‚¬50): <strong>â‚¬${totalHighValue.toFixed(2)}</strong></div>
            `;
        };

        // Sezione 5: Async/Await
        const demoFetchUsers = async () => {
            const output = document.getElementById('output5');
            output.innerHTML = '<div class="output-item">â³ Caricamento...</div>';
            
            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/users');
                const users = await response.json();
                
                // Prendi solo i primi 5
                const firstFive = users.slice(0, 5);
                
                const userList = firstFive.map(user => `
                    <div class="output-item">
                        ğŸ‘¤ <strong>${user.name}</strong> (${user.email})<br>
                        ğŸ¢ ${user.company.name}<br>
                        ğŸŒ ${user.address.city}
                    </div>
                `).join('');
                
                output.innerHTML = userList;
            } catch (error) {
                output.innerHTML = `<div class="output-item">âŒ Errore: ${error.message}</div>`;
            }
        };

        const demoAsyncOperations = async () => {
            const output = document.getElementById('output5');
            output.innerHTML = '<div class="output-item">â³ Eseguendo operazioni async...</div>';
            
            // Simulare operazioni async
            const fetchData = (name, delay) => {
                return new Promise(resolve => {
                    setTimeout(() => {
                        resolve(`âœ… ${name} completato dopo ${delay}ms`);
                    }, delay);
                });
            };
            
            const start = Date.now();
            
            // Esecuzione parallela con Promise.all
            const results = await Promise.all([
                fetchData('Task 1', 1000),
                fetchData('Task 2', 1500),
                fetchData('Task 3', 800)
            ]);
            
            const duration = Date.now() - start;
            
            output.innerHTML = `
                ${results.map(r => `<div class="output-item">${r}</div>`).join('')}
                <div class="output-item">â±ï¸ Tempo totale: <strong>${duration}ms</strong> (parallelo!)</div>
            `;
        };

        // Sezione 6: E-commerce Demo
        let currentProducts = [...products];

        const renderProducts = (productList) => {
            const grid = document.getElementById('productGrid');
            grid.innerHTML = productList.map(product => `
                <div class="product-card">
                    <h3>${product.name}</h3>
                    <div class="price">â‚¬${product.price.toFixed(2)}</div>
                    <div class="category">${product.category}</div>
                    <div style="margin-top: 8px; color: ${product.inStock ? 'green' : 'red'};">
                        ${product.inStock ? 'âœ… In Stock' : 'âŒ Out of Stock'}
                    </div>
                </div>
            `).join('');
            
            // Statistiche
            const total = productList.reduce((sum, p) => sum + p.price, 0);
            const avg = total / productList.length;
            const inStock = productList.filter(p => p.inStock).length;
            
            document.getElementById('output6').innerHTML = `
                <div class="output-item">ğŸ“¦ Prodotti mostrati: <strong>${productList.length}</strong></div>
                <div class="output-item">ğŸ’° Valore totale: <strong>â‚¬${total.toFixed(2)}</strong></div>
                <div class="output-item">ğŸ“Š Prezzo medio: <strong>â‚¬${avg.toFixed(2)}</strong></div>
                <div class="output-item">âœ… Disponibili: <strong>${inStock}/${productList.length}</strong></div>
            `;
        };

        const showAllProducts = () => {
            currentProducts = [...products];
            renderProducts(currentProducts);
        };

        const filterByCategory = (category) => {
            currentProducts = products.filter(p => p.category === category);
            renderProducts(currentProducts);
        };

        const filterByPrice = (maxPrice) => {
            currentProducts = products.filter(p => p.price < maxPrice);
            renderProducts(currentProducts);
        };

        const sortByPrice = () => {
            currentProducts = [...currentProducts].sort((a, b) => a.price - b.price);
            renderProducts(currentProducts);
        };

        // Inizializza demo e-commerce
        showAllProducts();
    </script>
</body>
</html>
